In August 1883, in the wake of Admiral Amédée Courbet's victory at the Battle of Thuận An, the Vietnamese court at Huế was forced to recognise a French protectorate over both Annam (French protectorate) and Tonkin. Efforts by the French to entrench their protectorate in Tonkin were complicated by the outbreak of the Sino-French War in August 1884, which tied down large French forces around Hưng Hóa and Lạng Sơn, and later by the Cần Vương uprising in southern Vietnam in July 1885, which required the diversion of French forces from Tonkin to Annam. When the Sino-French War ended in April 1885, there were 35,000 French troops in Tonkin, but the area of French control was restricted to the Red River Delta. Between April 1885 and April 1886 French troops closed up to the Chinese border, raising the tricolour and establishing customs posts at Lào Cai and other frontier crossings into Yunnan and Guangxi provinces, but large swathes of Tonkinese territory remained under the control of insurgent groups.