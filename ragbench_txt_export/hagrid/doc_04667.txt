James Watt, a Scottish inventor and mechanical engineer, greatly improved the steam engine of Thomas Newcomen, hitherto used to pump water out of mines. Watt developed a reciprocating engine in 1769, capable of powering a wheel. Although the Watt engine powered cotton mills and a variety of machinery, it was a large stationary engine. It could not be otherwise: the state of boiler technology necessitated the use of low pressure steam acting upon a vacuum in the cylinder; this required a separate condenser and an air pump. Nevertheless, as the construction of boilers improved, Watt investigated the use of high-pressure steam acting directly upon a piston. This raised the possibility of a smaller engine, that might be used to power a vehicle and he patented a design for a steam locomotive in 1784. His employee William Murdoch produced a working model of a self-propelled steam carriage in that year.
The first full-scale working railway steam locomotive was built in the United Kingdom in 1804 by Richard Trevithick, a British engineer born in Cornwall. This used high-pressure steam to drive the engine by one power stroke. The transmission system employed a large flywheel to even out the action of the piston rod. On 21 February 1804, the world's first steam-powered railway journey took place when Trevithick's unnamed steam locomotive hauled a train along the tramway of the Penydarren ironworks, near Merthyr Tydfil in South Wales. Trevithick later demonstrated a locomotive operating upon a piece of circular rail track in Bloomsbury, London, the "Catch Me Who Can", but never got beyond the experimental stage with railway locomotives, not least because his engines were too heavy for the cast-iron plateway track then in use.
The first commercially successful steam locomotive was Matthew Murray's rack locomotive "Salamanca" built for the Middleton Railway in Leeds in 1812. This twin-cylinder locomotive was not heavy enough to break the edge-rails track and solved the problem of adhesion by a cog-wheel using teeth cast on the side of one of the rails. Thus it was also the first rack railway.